# ==========    GENERAL    ==========

ontop
geometry=x70%
autofit-larger=80%x80%
prefetch-playlist=yes
force-seekable=yes
keep-open=yes
reset-on-next-file=pause
vd-lavc-fast=yes
d3d11va-zero-copy=yes
user-agent='Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0'
hr-seek=yes
hr-seek-framedrop=yes
script-opts=ytdl_hook-try_ytdl_first=yes,ytdl_hook-exclude="%.webm$|%.ts$|%.mp3$|%.m3u8$|%.m3u$|%.mkv$|%.mp4$|%.VOB$"

# ==========    ON SCREEN DISPLAY AND ON SCREEN CONTROLLER    ==========
osd-bar=no                                      # Sử dụng UOSC thay cho UI mặc định
osc=no                                          # Sử dụng UI morden-x thay cho mặc định
border=no                                       # Tắt title bar và border thay vào đó sử dụng của morden X
cursor-autohide=100                             # Trỏ chuột sẽ tử động ẩn sau ms
osd-level=1                                     # https://mpv.io/manual/stable/#options-osd-level
osd-duration=1000                               # Thời gian xuất hiện của OSD messages bằng ms
                                                # https://mpv.io/manual/stable/#options-hr-seek
# Tuỳ chỉnh style của OSD messages
osd-font="Open Sans"
osd-font-size=40
osd-border-size=2.4
osd-shadow-offset=0.75
osd-bold=yes

# ==========    Video Profile    ==========
hwdec=auto-safe
vo=gpu-next

#Cho he may cui bap, CPU va GPU giam cuc nhieu
tscale=nearest
interpolation=no
scale=bilinear
cscale=bilinear
dscale=bilinear
sws-scaler=fast-bilinear
dither=no
correct-downscaling=no
linear-downscaling=no
sigmoid-upscaling=no
hdr-compute-peak=no

#Bat lam net video, rat ngon CPU va GPU, tuy nhien giup vai video bi nhoe trong dep hon, khong nen bat mac dinh ma nen bat bang phim tat khi can thiet bang input.conf
#scale=ewa_lanczossharp
#cscale=ewa_lanczossharp

# ==========    AUDIO    ==========

volume=100                                      # Âm lượng mặc định
audio-file-auto=fuzzy                           # Load source âm thanh bên ngoài có tên gần giống với video
volume-max=200                                  # Dung lượng tối đa cho phép. Qua mức 100 mpv sẽ boost âm lượng từ video nên có thể gây ra suy giảm chất lượng âm thanh.
audio-pitch-correction=yes                      # tự động chèn scaletempo khi phát ở tốc độ cao hơn

# ==========    LANGUAGE PRIORITY    ==========

track-auto-selection=yes
alang=ja,jp,jpn,en,eng,vi,vie                   # Thứ tự uy tiên ngôn ngữ của audio
slang=vi,vie                                    # Thứ tự uy tiên ngôn ngữ của subtitles
sid=no

# ==========    SUBTITLES    ==========

demuxer-mkv-subtitle-preroll=yes                # https://mpv.io/manual/stable/#options-mkv-subtitle-preroll
sub-ass-vsfilter-blur-compat=no                 # Tương thích ngược với ASS/SSA sử dụng vsfilter
sub-fix-timing=no                               # Do not try to fix gaps (which might make it worse in some cases).
sub-auto=fuzzy                                  # Load subtitle bên ngoài có tên gần giống với video
sub-file-paths-append=ass
sub-file-paths-append=srt
sub-file-paths-append=pgs
sub-file-paths-append=vob
sub-file-paths-append=sub
sub-file-paths-append=sup
sub-file-paths-append=subs
sub-file-paths-append=subtitles
# Các tuỳ chọn sau áp dụng với định dạng subtitles không có style riêng (VD: SRT, VTT...)
# Đây là style yêu thích của mình có thể điều chỉnh lại style theo sở thích riêng
sub-font='Open Sans'
sub-font-size=60
sub-color='#FFFFFFFF'
sub-border-color="#FF000000"
sub-shadow-color=0.0/0.0/0.0/0.70
sub-border-size=2.0
sub-shadow-offset=0.75
sub-spacing=0.0
sub-bold=yes                             
sub-use-margins=no
sub-gauss=0.05

# ==========    CACHE & STREAMING    ==========
cache-pause
cache=auto
#cache-on-disk=yes                              # Bat len neu may it RAM, chuyen cache xuong o dia
cache-default=80000                             # size in KB (80MB) -- Increase if you have buffering issues
cache-backbuffer=80000                          # size in KB
cache-initial=0                                 # start playback when your cache is filled up with x kB
cache-secs=600                                  # how many seconds of audio/video to prefetch if the cache is active
demuxer-max-bytes=1GiB                          # Giới hạn kích thước dữ liệu cho phép demuxer đọc trước
demuxer-readahead-secs=300                      # Giới hạn thời gian cho phép demuxer đọc trước
demuxer-max-back-bytes=500MiB                   # Giới hạn kích thước dữ liệu demuxer đã đọc qua có thể lưu giữ

# ==========    NETWORK    ==========
network-timeout=100
stream-lavf-o-append=reconnect_on_http_error=4xx,5xx
stream-lavf-o-append=reconnect_delay_max=30
stream-lavf-o-append=reconnect_streamed=yes
#stream-lavf-o-append=reconnect_on_network_error=yes

# ==========    YT-DLP    ==========
load-unsafe-playlists=yes
ytdl-raw-options-append=no-check-certificates=
ytdl-raw-options-append=yes-playlist=
ytdl-raw-options-append=sub-langs=en,en-US,eng,vi,vi-VN,vie,live_chat
ytdl-raw-options-append=write-sub=
ytdl-raw-options-append=write-auto-sub=
ytdl-raw-options-append=add-metadata=
ytdl-raw-options-append=audio-multistreams=
ytdl-raw-options-append=video-multistreams=
ytdl-raw-options-append=cookies-from-browser=firefox:D:\Software\Floorp\Profiles\AppData\Floorp\Profiles\mtk6dv6d.default
ytdl-raw-options-append=mark-watched=
#ytdl-raw-options-append=extractor-args=youtube:player_skip=webpage,configs,js;player_client=android,web;lang=vi,en
#ytdl-raw-options-append=extractor-args=youtube:lang=vi,en

# ==========    DEBANDING    ==========

deband=no                                       # Chỉ nên bật khi video có banding. (Keybind=h)
deband-iterations=1                             # https://mpv.io/manual/stable/#options-deband-iterations
deband-threshold=48                             # https://mpv.io/manual/stable/#options-deband-threshold
deband-range=32                                 # https://mpv.io/manual/stable/#options-deband-threshold
deband-grain=32                                 # https://mpv.io/manual/stable/#options-deband-grain

# ==========    INTERPOLATION    ==========

# Tuỳ chọn filter cho nội suy temporal axis (frames).
tscale=oversample

# ==========   Tone-mapping   ==========
target-colorspace-hint=no                        # Buộc tonemapping HDR -> SDR nếu màn hình của bạn hỗ trợ HDR thì bật lên và bật HDR trong setting của Windows.
tone-mapping=spline
libplacebo-opts-append=gamut_expansion=yes       # Allows the gamut mapping function to expand the gamut, in cases where the target gamut exceeds that of the source
libplacebo-opts-append=perceptual_deadzone=0.4
libplacebo-opts-append=perceptual_strength=0.5

# ==========    PROFILE    ==========
#Luon de phan nay o cuoi file mpv.conf
[quality-youtube]
profile-cond=string.find(path, 'youtube') ~= nil or string.find(path, 'youtu.be') ~= nil or string.find(path, 'yt.be') ~= nil
profile-restore=copy
ytdl-format=bv[proto*=?m3u8][height<=?1080][fps<=?30][vcodec*=?avc1]+ba[acodec*=?opus]/22/best
#720 mp4
#ytdl-format=bv[container*=dash][height<=?720][fps<=?30][vcodec!=?vp9]+ba[acodec*=?opus]/18/best
#1080 av1
#ytdl-format=bestvideo[height<=?1080][vcodec*=?av01]+bestaudio/best

[stream-no-ytdl]
profile-cond=string.find(path, '%.m3u') ~= nil or string.find(path, '%.mpd') ~= nil or string.find(path, '%.mp4') ~= nil or string.find(path, 'googlevideo%.') ~= nil or string.find(path, '%.jpg') ~= nil or string.find(path, '%.png') ~= nil or string.find(path, '%.epg') ~= nil or string.find(path, '%.ts') ~= nil or string.find(path, '%.xml') ~= nil or string.find(path, 'epg') ~= nil or string.find(path, 'EXTM3U') ~= nil
profile-restore=copy-equal
ytdl=no

#EOF
